<!doctype html>
<html>
<head>
    <title>25 + 5 Clock</title>
    <meta charset='utf-8' />
    <meta name='viewport' content='width=device-width, initial-scale=1' />
    <link rel='stylesheet' href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>
<body>
    <div class='container'
        style='width: 500px;'
    >   <div class='row mt-3'
            style='border-bottom: 1px solid lightgray; text-align: center;'
        > <h1>Pomodoro Timer</h1>
        </div>
        <div class='row mt-3'>
            <div class='col-5'>
                <div class='row'>
                    <div id='break-label' style='text-align: center;'>Break Length</div>
                </div>
                <div class='row mt-1'>
                    <div class='col'>
                        <div class='row'>
                            <button id='break-decrement'
                                class='btn btn-light'
                            > <i class='bi bi-arrow-down'></i>
                            </button>
                        </div>
                    </div>
                    <div class='col d-flex justify-content-center align-items-center'>
                        <div class='row'>
                            <div id='break-length' style='text-align: center;'>5</div>
                        </div>
                    </div>
                    <div class='col'>
                        <div class='row'>
                            <button id='break-increment'
                                class='btn btn-light'
                            > <i class='bi bi-arrow-up'></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class='col-2'></div>
            <div class='col-5'>
                <div class='row'>
                    <div id='session-label' style='text-align: center;'>Session Length</div>
                </div>
                <div class='row mt-1'>
                    <div class='col'>
                        <div class='row'>
                            <button id='session-decrement'
                                class='btn btn-light'
                            > <i class='bi bi-arrow-down'></i>
                            </button>
                        </div>
                    </div>
                    <div class='col d-flex justify-content-center align-items-center'>
                        <div class='row'>
                            <div id='session-length'>25</div>
                        </div>
                    </div>
                    <div class='col'>
                        <div class='row'>
                            <button id='session-increment'
                                class='btn btn-light'
                            > <i class='bi bi-arrow-up'></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class='row mt-5'>
            <div class='col'>
                <div class='row'>
                    <h3 id='timer-label' style='text-align: center;'>Session</h3>
                </div>
                <div class='row'>
                    <h4 id='time-left' style='text-align: center;'>25:00</h4>
                </div>
                <div class='row mt-2'>
                    <div class='col'></div>
                    <div class='col me-1'>
                        <div class='row'>
                            <button id='start_stop'
                                class='btn btn-light'
                            >   <i id='start-icon' class='bi bi-play' style='display: block;'></i>
                                <i id='stop-icon' class='bi bi-pause' style='display: none;'></i>
                            </button>
                        </div>
                    </div>
                    <div class='col ms-1'>
                        <div class='row'>
                            <button id='reset'
                                class='btn btn-light'
                            > <i class="bi bi-arrow-clockwise"></i>
                            </button> 
                        </div>
                    </div>
                    <div class='col'></div>
                </div>
                <audio id='beep' src='https://cdn.freecodecamp.org/testable-projects-fcc/audio/BeepSound.wav'></audio>
            </div>
        </div>
    </div>
</body>
<script src='https://code.jquery.com/jquery-3.7.1.slim.min.js'></script>
<script>

let time = 25 * 60;
let type = false;
let btime = 5;
let stime = 25;

function display_time() {
    const min_raw = Math.floor(time / 60);
    const sec_raw = time % 60;
    const min = (min_raw < 10) ? `0${min_raw}` : `${min_raw}`;
    const sec = (sec_raw < 10) ? `0${sec_raw}` : `${sec_raw}`;
    $('#time-left').text(`${min}:${sec}`);
};

function check_time() {
    if (time != 0) return;
    if (type) {
        time = stime * 60 + 1;
        $('#timer-label').text('Session');
    } else {
        time = btime * 60 + 1;
        $('#timer-label').text('Break');
    };
    type = !type;
    $('#beep')[0].currentTime = 0;
    $('#beep')[0].play();
};


function decrement() {
    time--;
    display_time();
    check_time();
};

let pause = false;
let interval = false;
function init_time() {
    if (pause) {
        $('#start-icon').show();
        $('#stop-icon').hide();
        clearInterval(interval);
    } else {
        $('#start-icon').hide();
        $('#stop-icon').show();
        interval = setInterval(decrement, 1000);
    };
    pause = !pause;
};

function reset_time() {
    type = false;
    pause = true;
    init_time();
    btime = 5;
    stime = 25;
    time = stime * 60;
    display_btime();
    display_stime();
    display_time();
    $('#timer-label').text('Session')
    $('#beep')[0].pause();
    $('#beep')[0].currentTime = 0;
};

function update_time() {
    if (type) time = btime * 60
    else time = stime * 60;
    display_time();
};

function display_btime() {
    $('#break-length').text(`${btime}`);
    if (type) update_time();
};

function display_stime() {
    $('#session-length').text(`${stime}`)
    if (!type) update_time();
};

function btime_inc() {
    if (pause) return;
    if (btime >= 60) return;
    btime++;
    display_btime();
};

function btime_dec() {
    if (pause) return;
    if (btime <= 01) return;
    btime--;
    display_btime();
};

function stime_inc() {
    if (pause) return;
    if (stime >= 60) return;
    stime++;
    display_stime();
};

function stime_dec() {
    if (pause) return;
    if (stime <= 01) return;
    stime--;
    display_stime();
};

$('#start_stop').click(init_time);
$('#reset').click(reset_time);
$('#break-increment').click(btime_inc);
$('#break-decrement').click(btime_dec);
$('#session-increment').click(stime_inc);
$('#session-decrement').click(stime_dec);

</script>
</html>
